housemarket_clean$`Laatste vraagprijs` <- str_replace(housemarket_clean$`Laatste vraagprijs`, 'Prijs op aanvraag', "")
#convert blank spaces introduced by cleaning to NA (in order to remove them)
housemarket_clean <- housemarket_clean %>% mutate_all(na_if,"")
#remove NA's again
housemarket_clean <- housemarket_clean %>% drop_na()
View(housemarket_clean)
housemarket_clean$`Laatste vraagprijs_num` <- as.numeric(housemarket_clean$`Laatste vraagprijs`)
housemarket_clean$`Laatste vraagprijs` <- str_replace(housemarket_clean$`Laatste vraagprijs`, '€', "")
View(housemarket_clean)
housemarket_clean <- housemarket_clean[-c(5)]
housemarket_clean$`Laatste vraagprijs_num` <- as.numeric(housemarket_clean$`Laatste vraagprijs`)
housemarket_clean$`Laatste vraagprijs_num` <- as.numeric(as.character(housemarket_clean$`Laatste vraagprijs`))
housemarket_clean$`Laatste vraagprijs` <- str_replace(housemarket_clean$`Laatste vraagprijs`, '.', ",")
merged_data_housemarket <- read_csv('../../gen/data-preparation/output/second_output(merged file)/merged_data_housemarket.csv')
housemarket_dataset_na <- merged_data_housemarket[c(4,8,9,14)]
housemarket_clean <- housemarket_dataset_na %>% drop_na()
View(housemarket_clean)
housemarket_clean$`Laatste vraagprijs` <-  str_replace(housemarket_clean$`Laatste vraagprijs`, "kosten koper", "")
housemarket_clean$`Laatste vraagprijs` <- str_replace(housemarket_clean$`Laatste vraagprijs`, 'vrij op naam', "")
housemarket_clean$`Laatste vraagprijs` <- str_replace(housemarket_clean$`Laatste vraagprijs`, '\nHypotheekadvies', "")
housemarket_clean$`Laatste vraagprijs` <- str_replace(housemarket_clean$`Laatste vraagprijs`, 'Prijs op aanvraag', "")
housemarket_clean <- housemarket_clean %>% mutate_all(na_if,"")
housemarket_clean <- housemarket_clean %>% drop_na()
housemarket_clean$`Laatste vraagprijs_num` <- as.numeric(gsub('[€.]', '', housemarket_clean$`Laatste vraagprijs`))
merged_data_housemarket <- read_csv('../../gen/data-preparation/output/second_output(merged file)/merged_data_housemarket.csv')
View(merged_data_housemarket)
#remove everything but city, price, selling duration and construction year
housemarket_dataset_na <- merged_data_housemarket[c(4,6,7,9,14)]
housemarket_clean <- housemarket_dataset_na %>% drop_na()
#remove unwanted characterss
housemarket_clean$`Laatste vraagprijs` <-  str_replace(housemarket_clean$`Laatste vraagprijs`, "kosten koper", "")
housemarket_clean$`Laatste vraagprijs` <- str_replace(housemarket_clean$`Laatste vraagprijs`, 'vrij op naam', "")
housemarket_clean$`Laatste vraagprijs` <- str_replace(housemarket_clean$`Laatste vraagprijs`, '\nHypotheekadvies', "")
housemarket_clean$`Laatste vraagprijs` <- str_replace(housemarket_clean$`Laatste vraagprijs`, 'Prijs op aanvraag', "")
#housemarket_clean$`Laatste vraagprijs` <- str_replace(housemarket_clean$`Laatste vraagprijs`, '€', "")
#convert blank spaces introduced by cleaning to NA (in order to remove them)
housemarket_clean <- housemarket_clean %>% mutate_all(na_if,"")
#remove NA's again
housemarket_clean <- housemarket_clean %>% drop_na()
#create new NUMERIC variable for price
housemarket_clean$`Laatste vraagprijs_num` <- as.numeric(gsub('[€.]', '', housemarket_clean$`Laatste vraagprijs`))
View(housemarket_clean)
housemarket_clean$`Aangeboden sinds_2` <- as.date(housemarket_clean$`Aangeboden sinds`)
install.packages(lubridate)
library(lubridate)
housemarket_clean$`Aangeboden sinds` <- format(mdy(housemarket_clean$`Aangeboden sinds`),'%d/%m/%Y )
housemarket_clean$`Aangeboden sinds_2` <- format(mdy(housemarket_clean$`Aangeboden sinds`),%d/%m/%Y )
print("hello")
print("hello")
print("hello")
}
print("hello")
setwd("~/Desktop/dprep/investigating-funda/src/data-preparation")
library(tibble)
library(tidyverse)
Eindhoven <- read_csv("../../gen/input/Eindhoven.csv")
Eindhoven
fn="../../gen/input/eindhoven.csv"
fn
strsplit(fn,'/')
strsplit(fn,'/')[[1]]
rev(strsplit(fn,'/')[[1]])
rev(strsplit(fn,'/')[[1]])[1]
stad<- rev(strsplit(fn,'/')[[1]])[1]
stad <- gsub('[.]csv','',stad)
stad
data <- read_csv(fn)
stad<- rev(strsplit(fn,'/')[[1]])[1]
stad <- gsub('[.]csv','',stad)
data$stad <- stad
data
colnames(data)
table(data$stad)
files
files = c("../../gen/input/eindhoven.csv",
"../../gen/input/maastricht.csv",
"../../gen/input/dordrecht.csv",
"../../gen/input/leeuwarden.csv")
files = c("../../gen/input/eindhoven.csv",
"../../gen/input/maastricht.csv",
"../../gen/input/dordrecht.csv",
"../../gen/input/leeuwarden.csv")
all_cities = lapply(files, function(fn) {
data <- read_csv(fn)
stad<- rev(strsplit(fn,'/')[[1]])[1]
stad <- gsub('[.]csv','',stad)
data$stad <- stad
#dir.create('../../gen/data-preparation/output/')
#write.csv(Eindhoven, '../../gen/data-preparation/output/first_output(appended citynames)/Eindhoven_appended_cityname.csv')
return(data)
})
all_cities[[1]]
all_cities[[2]]
all_cities[[3]]
merged = do.call('rbind',all_cities)
merged = do.call('rbind',all_cities,fill=T)
all_cities = lapply(files, function(fn) {
data <- read_csv(fn)
stad<- rev(strsplit(fn,'/')[[1]])[1]
stad <- gsub('[.]csv','',stad)
data$stad <- stad
dir.create('../../gen/data-preparation/output/first_output(appended citynames)/')
write.csv(stad, paste0('../../gen/data-preparation/output/first_output(appended citynames)/'+stad+'.csv'))
return(data)
})
all_cities = lapply(files, function(fn) {
data <- read_csv(fn)
stad<- rev(strsplit(fn,'/')[[1]])[1]
stad <- gsub('[.]csv','',stad)
data$stad <- stad
dir.create('../../gen/data-preparation/output/first_output(appended citynames)/')
write.csv(stad, paste0('../../gen/data-preparation/output/first_output(appended citynames)/',stad,'.csv'))
return(data)
})
files = c("../../gen/input/eindhoven.csv",
"../../gen/input/maastricht.csv",
"../../gen/input/dordrecht.csv",
"../../gen/input/leeuwarden.csv")
all_cities = lapply(files, function(fn) {
data <- read_csv(fn)
stad<- rev(strsplit(fn,'/')[[1]])[1]
stad <- gsub('[.]csv','',stad)
data$stad <- stad
#dir.create('../../gen/data-preparation/output/first_output(appended citynames)/')
#write.csv(stad, paste0('../../gen/data-preparation/output/first_output(appended citynames)/',stad,'.csv'))
return(data)
})
all_cities
library(tibble)
library(tidyverse)
library(data.table)
files = c("../../gen/input/eindhoven.csv",
"../../gen/input/maastricht.csv",
"../../gen/input/dordrecht.csv",
"../../gen/input/leeuwarden.csv")
all_cities = lapply(files, function(fn) {
data <- read_csv(fn)
stad<- rev(strsplit(fn,'/')[[1]])[1]
stad <- gsub('[.]csv','',stad)
data$stad <- stad
#dir.create('../../gen/data-preparation/output/first_output(appended citynames)/')
#write.csv(stad, paste0('../../gen/data-preparation/output/first_output(appended citynames)/',stad,'.csv'))
return(data.table(data))
})
rbindlist(all_cities)
rbindlist(all_cities,fill=T)
merged = rbindlist(all_cities,fill=T)
table(merged$stad)
list.files
files = list.files(pattern='[.]csv', path ="../../gen/input/",
full.names=T)
files
files = list.files(pattern='[.]csv', path ="../../gen/input/",
full.names=T)
all_cities = lapply(files, function(fn) {
data <- read_csv(fn)
stad<- rev(strsplit(fn,'/')[[1]])[1]
stad <- gsub('[.]csv','',stad)
data$stad <- stad
#dir.create('../../gen/data-preparation/output/first_output(appended citynames)/')
#write.csv(stad, paste0('../../gen/data-preparation/output/first_output(appended citynames)/',stad,'.csv'))
return(data.table(data))
})
merged = rbindlist(all_cities,fill=T)
merged
source('~/Desktop/dprep/investigating-funda/src/data-preparation/addcityname.R')
merged_cities <- read_csv('.../../gen/data-preparation/output/merged_cities.csv')
library(readr)
merged_cities <- read_csv("~/Desktop/dprep/investigating-funda/gen/data-preparation/output/merged_cities.csv")
View(merged_cities)
library(tidyverse)
library(tidyr)
library(dplyr)
merged_cities %>% select(`Aangeboden sinds`, Verkoopdatum, `Laatste vraagprijs`, stad, Bouwjaar)
merged_cities <- merged_cities %>% select(`Aangeboden sinds`, Verkoopdatum, `Laatste vraagprijs`, stad, Bouwjaar)
merged_cities_clean$`Laatste vraagprijs` <- str_replace_all(merged_cities_clean$`Laatste vraagprijs`, c('kosten koper' = "",
'vrij op naam' = "", '\nHypotheekadvies'= "",
'Prijs op aanvraag'=""))
merged_cities_clean <- merged_cities %>% drop_na()
merged_cities_clean$`Laatste vraagprijs` <- str_replace_all(merged_cities_clean$`Laatste vraagprijs`, c('kosten koper' = "",
'vrij op naam' = "", '\nHypotheekadvies'= "",
'Prijs op aanvraag'=""))
View(merged_cities_clean)
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
merged_cities_clean <- merged_cities_clean %>% drop_na()
merged_cities_clean$`Laatste vraagprijs_num` <- as.numeric(gsub('[€.]', '', merged_cities_clean$`Laatste vraagprijs`))
#convert Bouwjaar into NUMERIC variable
merged_cities_clean$Bouwjaar <-  str_replace(merged_cities_clean$Bouwjaar, "Voor 1906", "1906")
merged_cities_clean$Bouwjaar <- as.numeric(merged_cities_clean$Bouwjaar)
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
#convert month names to numerics sinds and selling date
merged_cities_clean$`Aangeboden sinds_date_2` <-  str_replace_all(merged_cities_clean$`Aangeboden sinds`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
merged_cities_clean$`Verkoopdatum_2` <-  str_replace_all(merged_cities_clean$`Verkoopdatum`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
#convert dates with as.Date
merged_cities_clean$`Aangeboden sinds_date_2` <- as.Date(merged_cities_clean$`Aangeboden sinds_date_2`, format = "%d-%m-%Y")
merged_cities_clean$`Verkoopdatum_2` <- as.Date(merged_cities_clean$`Verkoopdatum_2` , format = "%d-%m-%Y")
#create new column with time between days
merged_cities_clean$sellingduration <- difftime(merged_cities_clean$`Verkoopdatum_2`, merged_cities_clean$`Aangeboden sinds_date_2`, units = c("days"))
merged_cities_clean <- merged_cities %>% select(sellingduration, Laatste vraagprijs_num, stad, Bouwjaar)
merged_cities_clean <- merged_cities %>% select(sellingduration, `Laatste vraagprijs_num`, stad, Bouwjaar)
merged_cities_clean <- merged_cities %>% select(sellingduration, `Laatste vraagprijs_num`, stad, Bouwjaar)
merged_cities_clean <- merged_cities %>% select(`sellingduration`, `Laatste vraagprijs_num`, stad, Bouwjaar)
merged_cities_clean <- merged_cities_clean %>% select(`sellingduration`, `Laatste vraagprijs_num`, stad, Bouwjaar)
library(dplyr)
names(housemarket_clean)[2] <- "Selling Price (in euros)"
names(housemarket_clean)[1] <- "Selling Duration (in days)"
library(dplyr)
names(merged_cities_clean)[2] <- "Selling Price (in euros)"
names(merged_cities_clean)[1] <- "Selling Duration (in days)"
#Cleaning data
library(tidyverse)
library(tidyr)
library(dplyr)
merged_cities <- read_csv('.../../gen/data-preparation/output/merged_cities.csv')
#remove everything but city, price, offered since, selling date and construction year
merged_cities <- merged_cities %>% select(`Aangeboden sinds`, Verkoopdatum, `Laatste vraagprijs`, stad, Bouwjaar)
#remove na's
merged_cities_clean <- merged_cities %>% drop_na()
#remove unwanted characters to be able to convert price in numeric
merged_cities_clean$`Laatste vraagprijs` <- str_replace_all(merged_cities_clean$`Laatste vraagprijs`, c('kosten koper' = "",
'vrij op naam' = "", '\nHypotheekadvies'= "",
'Prijs op aanvraag'=""))
#convert blank spaces introduced by cleaning to NA (in order to remove them) and drop them
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
merged_cities_clean <- merged_cities_clean %>% drop_na()
#create new NUMERIC variable for price
merged_cities_clean$`Laatste vraagprijs_num` <- as.numeric(gsub('[€.]', '', merged_cities_clean$`Laatste vraagprijs`))
#convert Bouwjaar into NUMERIC variable
merged_cities_clean$Bouwjaar <-  str_replace(merged_cities_clean$Bouwjaar, "Voor 1906", "1906")
merged_cities_clean$Bouwjaar <- as.numeric(merged_cities_clean$Bouwjaar)
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
#convert month names to numerics sinds and selling date
merged_cities_clean$`Aangeboden sinds_date_2` <-  str_replace_all(merged_cities_clean$`Aangeboden sinds`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
merged_cities_clean$`Verkoopdatum_2` <-  str_replace_all(merged_cities_clean$`Verkoopdatum`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
#convert dates with as.Date
merged_cities_clean$`Aangeboden sinds_date_2` <- as.Date(merged_cities_clean$`Aangeboden sinds_date_2`, format = "%d-%m-%Y")
merged_cities_clean$`Verkoopdatum_2` <- as.Date(merged_cities_clean$`Verkoopdatum_2` , format = "%d-%m-%Y")
#create new column with time between days
merged_cities_clean$sellingduration <- difftime(merged_cities_clean$`Verkoopdatum_2`, merged_cities_clean$`Aangeboden sinds_date_2`, units = c("days"))
#remove unnecessary columns
merged_cities_clean <- merged_cities_clean[c(1,5,6,9)]
merged_cities_clean <- merged_cities_clean %>% select(`sellingduration`, `Laatste vraagprijs_num`, stad, Bouwjaar)
#rename columns
library(dplyr)
names(merged_cities_clean)[2] <- "Selling Price (in euros)"
names(merged_cities_clean)[1] <- "Selling Duration (in days)"
#write csv with cleaned data
write.csv(merged_cities_clean, '../../gen/data-preparation/output/final_cleaned_dataset_housemarket.csv')
merged_cities <- read_csv('../gen/data-preparation/output/merged_cities.csv')
merged_cities <- read_csv('../../gen/data-preparation/output/merged_cities.csv')
#Cleaning data
library(tidyverse)
library(tidyr)
library(dplyr)
merged_cities <- read_csv('../../gen/data-preparation/output/merged_cities.csv')
#remove everything but city, price, offered since, selling date and construction year
merged_cities <- merged_cities %>% select(`Aangeboden sinds`, Verkoopdatum, `Laatste vraagprijs`, stad, Bouwjaar)
#remove na's
merged_cities_clean <- merged_cities %>% drop_na()
#remove unwanted characters to be able to convert price in numeric
merged_cities_clean$`Laatste vraagprijs` <- str_replace_all(merged_cities_clean$`Laatste vraagprijs`, c('kosten koper' = "",
'vrij op naam' = "", '\nHypotheekadvies'= "",
'Prijs op aanvraag'=""))
#convert blank spaces introduced by cleaning to NA (in order to remove them) and drop them
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
merged_cities_clean <- merged_cities_clean %>% drop_na()
#create new NUMERIC variable for price
merged_cities_clean$`Laatste vraagprijs_num` <- as.numeric(gsub('[€.]', '', merged_cities_clean$`Laatste vraagprijs`))
#convert Bouwjaar into NUMERIC variable
merged_cities_clean$Bouwjaar <-  str_replace(merged_cities_clean$Bouwjaar, "Voor 1906", "1906")
merged_cities_clean$Bouwjaar <- as.numeric(merged_cities_clean$Bouwjaar)
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
#convert month names to numerics sinds and selling date
merged_cities_clean$`Aangeboden sinds_date_2` <-  str_replace_all(merged_cities_clean$`Aangeboden sinds`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
merged_cities_clean$`Verkoopdatum_2` <-  str_replace_all(merged_cities_clean$`Verkoopdatum`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
#convert dates with as.Date
merged_cities_clean$`Aangeboden sinds_date_2` <- as.Date(merged_cities_clean$`Aangeboden sinds_date_2`, format = "%d-%m-%Y")
merged_cities_clean$`Verkoopdatum_2` <- as.Date(merged_cities_clean$`Verkoopdatum_2` , format = "%d-%m-%Y")
#create new column with time between days
merged_cities_clean$sellingduration <- difftime(merged_cities_clean$`Verkoopdatum_2`, merged_cities_clean$`Aangeboden sinds_date_2`, units = c("days"))
#remove unnecessary columns
merged_cities_clean <- merged_cities_clean[c(1,5,6,9)]
merged_cities_clean <- merged_cities_clean %>% select(`sellingduration`, `Laatste vraagprijs_num`, stad, Bouwjaar)
#rename columns
library(dplyr)
names(merged_cities_clean)[2] <- "Selling Price (in euros)"
names(merged_cities_clean)[1] <- "Selling Duration (in days)"
#write csv with cleaned data
write.csv(merged_cities_clean, '../../gen/data-preparation/output/final_cleaned_dataset_housemarket.csv')
#Cleaning data
library(tidyverse)
library(tidyr)
library(dplyr)
merged_cities <- read_csv('../../gen/data-preparation/output/merged_cities.csv')
#remove everything but city, price, offered since, selling date and construction year
merged_cities <- merged_cities %>% select(`Aangeboden sinds`, Verkoopdatum, `Laatste vraagprijs`, stad, Bouwjaar)
#remove na's
merged_cities_clean <- merged_cities %>% drop_na()
#remove unwanted characters to be able to convert price in numeric
merged_cities_clean$`Laatste vraagprijs` <- str_replace_all(merged_cities_clean$`Laatste vraagprijs`, c('kosten koper' = "",
'vrij op naam' = "", '\nHypotheekadvies'= "",
'Prijs op aanvraag'=""))
#convert blank spaces introduced by cleaning to NA (in order to remove them) and drop them
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
merged_cities_clean <- merged_cities_clean %>% drop_na()
#create new NUMERIC variable for price
merged_cities_clean$`Laatste vraagprijs_num` <- as.numeric(gsub('[€.]', '', merged_cities_clean$`Laatste vraagprijs`))
#convert Bouwjaar into NUMERIC variable
merged_cities_clean$Bouwjaar <-  str_replace(merged_cities_clean$Bouwjaar, "Voor 1906", "1906")
merged_cities_clean$Bouwjaar <- as.numeric(merged_cities_clean$Bouwjaar)
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
#convert month names to numerics sinds and selling date
merged_cities_clean$`Aangeboden sinds_date_2` <-  str_replace_all(merged_cities_clean$`Aangeboden sinds`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
merged_cities_clean$`Verkoopdatum_2` <-  str_replace_all(merged_cities_clean$`Verkoopdatum`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
#convert dates with as.Date
merged_cities_clean$`Aangeboden sinds_date_2` <- as.Date(merged_cities_clean$`Aangeboden sinds_date_2`, format = "%d-%m-%Y")
merged_cities_clean$`Verkoopdatum_2` <- as.Date(merged_cities_clean$`Verkoopdatum_2` , format = "%d-%m-%Y")
#create new column with time between days
merged_cities_clean$sellingduration <- difftime(merged_cities_clean$`Verkoopdatum_2`, merged_cities_clean$`Aangeboden sinds_date_2`, units = c("days"))
#remove unnecessary columns
merged_cities_clean <- merged_cities_clean %>% select(`sellingduration`, `Laatste vraagprijs_num`, stad, Bouwjaar)
#rename columns
library(dplyr)
names(merged_cities_clean)[2] <- "Selling Price (in euros)"
names(merged_cities_clean)[1] <- "Selling Duration (in days)"
#write csv with cleaned data
write.csv(merged_cities_clean, '../../gen/data-preparation/output/final_cleaned_dataset_housemarket.csv')
#Cleaning data
library(tidyverse)
library(tidyr)
library(dplyr)
merged_cities <- read_csv('../../gen/data-preparation/output/merged_cities.csv')
#remove everything but city, price, offered since, selling date and construction year
merged_cities <- merged_cities %>% select(`Aangeboden sinds`, Verkoopdatum, `Laatste vraagprijs`, stad, Bouwjaar)
#remove na's
merged_cities_clean <- merged_cities %>% drop_na()
#remove unwanted characters to be able to convert price in numeric
merged_cities_clean$`Laatste vraagprijs` <- str_replace_all(merged_cities_clean$`Laatste vraagprijs`, c('kosten koper' = "",
'vrij op naam' = "", '\nHypotheekadvies'= "",
'Prijs op aanvraag'=""))
#convert blank spaces introduced by cleaning to NA (in order to remove them) and drop them
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
merged_cities_clean <- merged_cities_clean %>% drop_na()
#create new NUMERIC variable for price
merged_cities_clean$`Laatste vraagprijs_num` <- as.numeric(gsub('[€.]', '', merged_cities_clean$`Laatste vraagprijs`))
#convert Bouwjaar into NUMERIC variable
merged_cities_clean$Bouwjaar <-  str_replace(merged_cities_clean$Bouwjaar, "Voor 1906", "1906")
merged_cities_clean$Bouwjaar <- as.numeric(merged_cities_clean$Bouwjaar)
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
#convert month names to numerics sinds and selling date
merged_cities_clean$`Aangeboden sinds_date_2` <-  str_replace_all(merged_cities_clean$`Aangeboden sinds`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
merged_cities_clean$`Verkoopdatum_2` <-  str_replace_all(merged_cities_clean$`Verkoopdatum`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
#convert dates with as.Date
merged_cities_clean$`Aangeboden sinds_date_2` <- as.Date(merged_cities_clean$`Aangeboden sinds_date_2`, format = "%d-%m-%Y")
merged_cities_clean$`Verkoopdatum_2` <- as.Date(merged_cities_clean$`Verkoopdatum_2` , format = "%d-%m-%Y")
#create new column with time between days
merged_cities_clean$sellingduration <- difftime(merged_cities_clean$`Verkoopdatum_2`, merged_cities_clean$`Aangeboden sinds_date_2`, units = c("days"))
#remove unnecessary columns
merged_cities_clean <- merged_cities_clean %>% select(`sellingduration`, `Laatste vraagprijs_num`, stad, Bouwjaar)
#rename columns
library(dplyr)
names(merged_cities_clean)[2] <- "Selling Price (in euros)"
names(merged_cities_clean)[1] <- "Selling Duration (in days)"
#write csv with cleaned data
write.csv(merged_cities_clean, '../../gen/data-preparation/output/cleaned_dataset_housemarket.csv')
#Cleaning data
library(tidyverse)
library(tidyr)
library(dplyr)
merged_cities <- read_csv('../../gen/data-preparation/output/merged_cities.csv')
#remove everything but city, price, offered since, selling date and construction year
merged_cities <- merged_cities %>% select(`Aangeboden sinds`, Verkoopdatum, `Laatste vraagprijs`, stad, Bouwjaar)
#remove na's
merged_cities_clean <- merged_cities %>% drop_na()
#remove unwanted characters to be able to convert price in numeric
merged_cities_clean$`Laatste vraagprijs` <- str_replace_all(merged_cities_clean$`Laatste vraagprijs`, c('kosten koper' = "",
'vrij op naam' = "", '\nHypotheekadvies'= "",
'Prijs op aanvraag'=""))
#convert blank spaces introduced by cleaning to NA (in order to remove them) and drop them
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
merged_cities_clean <- merged_cities_clean %>% drop_na()
#create new NUMERIC variable for price
merged_cities_clean$`Laatste vraagprijs_num` <- as.numeric(gsub('[€.]', '', merged_cities_clean$`Laatste vraagprijs`))
#convert Bouwjaar into NUMERIC variable
merged_cities_clean$Bouwjaar <-  str_replace(merged_cities_clean$Bouwjaar, "Voor 1906", "1906")
merged_cities_clean$Bouwjaar <- as.numeric(merged_cities_clean$Bouwjaar)
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
#convert month names to numerics sinds and selling date
merged_cities_clean$`Aangeboden sinds_date_2` <-  str_replace_all(merged_cities_clean$`Aangeboden sinds`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
merged_cities_clean$`Verkoopdatum_2` <-  str_replace_all(merged_cities_clean$`Verkoopdatum`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
#convert dates with as.Date
merged_cities_clean$`Aangeboden sinds_date_2` <- as.Date(merged_cities_clean$`Aangeboden sinds_date_2`, format = "%d-%m-%Y")
merged_cities_clean$`Verkoopdatum_2` <- as.Date(merged_cities_clean$`Verkoopdatum_2` , format = "%d-%m-%Y")
#create new column with time between days
merged_cities_clean$sellingduration <- difftime(merged_cities_clean$`Verkoopdatum_2`, merged_cities_clean$`Aangeboden sinds_date_2`, units = c("days"))
#remove unnecessary columns
merged_cities_clean <- merged_cities_clean %>% select(`sellingduration`, `Laatste vraagprijs_num`, stad, Bouwjaar)
#rename columns
library(dplyr)
names(merged_cities_clean)[2] <- "Selling Price (in euros)"
names(merged_cities_clean)[1] <- "Selling Duration (in days)"
#write csv with cleaned data
fwrite(merged_cities_clean, '.../../gen/data-preparation/output/cleaned_dataset_housemarket.csv')
#Cleaning data
library(tidyverse)
library(tidyr)
library(dplyr)
merged_cities <- read_csv('../../gen/data-preparation/output/merged_cities.csv')
#remove everything but city, price, offered since, selling date and construction year
merged_cities <- merged_cities %>% select(`Aangeboden sinds`, Verkoopdatum, `Laatste vraagprijs`, stad, Bouwjaar)
#remove na's
merged_cities_clean <- merged_cities %>% drop_na()
#remove unwanted characters to be able to convert price in numeric
merged_cities_clean$`Laatste vraagprijs` <- str_replace_all(merged_cities_clean$`Laatste vraagprijs`, c('kosten koper' = "",
'vrij op naam' = "", '\nHypotheekadvies'= "",
'Prijs op aanvraag'=""))
#convert blank spaces introduced by cleaning to NA (in order to remove them) and drop them
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
merged_cities_clean <- merged_cities_clean %>% drop_na()
#create new NUMERIC variable for price
merged_cities_clean$`Laatste vraagprijs_num` <- as.numeric(gsub('[€.]', '', merged_cities_clean$`Laatste vraagprijs`))
#convert Bouwjaar into NUMERIC variable
merged_cities_clean$Bouwjaar <-  str_replace(merged_cities_clean$Bouwjaar, "Voor 1906", "1906")
merged_cities_clean$Bouwjaar <- as.numeric(merged_cities_clean$Bouwjaar)
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
#convert month names to numerics sinds and selling date
merged_cities_clean$`Aangeboden sinds_date_2` <-  str_replace_all(merged_cities_clean$`Aangeboden sinds`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
merged_cities_clean$`Verkoopdatum_2` <-  str_replace_all(merged_cities_clean$`Verkoopdatum`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
#convert dates with as.Date
merged_cities_clean$`Aangeboden sinds_date_2` <- as.Date(merged_cities_clean$`Aangeboden sinds_date_2`, format = "%d-%m-%Y")
merged_cities_clean$`Verkoopdatum_2` <- as.Date(merged_cities_clean$`Verkoopdatum_2` , format = "%d-%m-%Y")
#create new column with time between days
merged_cities_clean$sellingduration <- difftime(merged_cities_clean$`Verkoopdatum_2`, merged_cities_clean$`Aangeboden sinds_date_2`, units = c("days"))
#remove unnecessary columns
merged_cities_clean <- merged_cities_clean %>% select(`sellingduration`, `Laatste vraagprijs_num`, stad, Bouwjaar)
#rename columns
library(dplyr)
names(merged_cities_clean)[2] <- "Selling Price (in euros)"
names(merged_cities_clean)[1] <- "Selling Duration (in days)"
#write csv with cleaned data
fwrite(merged_cities_clean, '.../../gen/data-preparation/output/cleaned_dataset_housemarket.csv')
fwrite(merged_cities_clean, '../../gen/data-preparation/output/cleaned_dataset_housemarket.csv')
#Cleaning data
library(tidyverse)
library(tidyr)
library(dplyr)
merged_cities <- read_csv('../../gen/data-preparation/output/merged_cities.csv')
#remove everything but city, price, offered since, selling date and construction year
merged_cities <- merged_cities %>% select(`Aangeboden sinds`, Verkoopdatum, `Laatste vraagprijs`, stad, Bouwjaar)
#remove na's
merged_cities_clean <- merged_cities %>% drop_na()
#remove unwanted characters to be able to convert price in numeric
merged_cities_clean$`Laatste vraagprijs` <- str_replace_all(merged_cities_clean$`Laatste vraagprijs`, c('kosten koper' = "",
'vrij op naam' = "", '\nHypotheekadvies'= "",
'Prijs op aanvraag'=""))
#convert blank spaces introduced by cleaning to NA (in order to remove them) and drop them
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
merged_cities_clean <- merged_cities_clean %>% drop_na()
#create new NUMERIC variable for price
merged_cities_clean$`Laatste vraagprijs_num` <- as.numeric(gsub('[€.]', '', merged_cities_clean$`Laatste vraagprijs`))
#convert Bouwjaar into NUMERIC variable
merged_cities_clean$Bouwjaar <-  str_replace(merged_cities_clean$Bouwjaar, "Voor 1906", "1906")
merged_cities_clean$Bouwjaar <- as.numeric(merged_cities_clean$Bouwjaar)
merged_cities_clean <- merged_cities_clean %>% mutate_all(na_if,"")
#convert month names to numerics sinds and selling date
merged_cities_clean$`Aangeboden sinds_date_2` <-  str_replace_all(merged_cities_clean$`Aangeboden sinds`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
merged_cities_clean$`Verkoopdatum_2` <-  str_replace_all(merged_cities_clean$`Verkoopdatum`, c("januari"= "01", "februari"= "02", "maart"= "03", "april"= "04", "mei"= "05", "juni"= "06",
"juli"="07", "augustus"= "08", "september"= "09", "oktober"= "10", "november"= "11",
"december"= "12", " "= "-"))
#convert dates with as.Date
merged_cities_clean$`Aangeboden sinds_date_2` <- as.Date(merged_cities_clean$`Aangeboden sinds_date_2`, format = "%d-%m-%Y")
merged_cities_clean$`Verkoopdatum_2` <- as.Date(merged_cities_clean$`Verkoopdatum_2` , format = "%d-%m-%Y")
#create new column with time between days
merged_cities_clean$sellingduration <- difftime(merged_cities_clean$`Verkoopdatum_2`, merged_cities_clean$`Aangeboden sinds_date_2`, units = c("days"))
#remove unnecessary columns
merged_cities_clean <- merged_cities_clean %>% select(`sellingduration`, `Laatste vraagprijs_num`, stad, Bouwjaar)
#rename columns
library(dplyr)
names(merged_cities_clean)[2] <- "Selling Price (in euros)"
names(merged_cities_clean)[1] <- "Selling Duration (in days)"
#write csv with cleaned data
fwrite(merged_cities_clean, '../../gen/data-preparation/output/cleaned_dataset_housemarket.csv')
